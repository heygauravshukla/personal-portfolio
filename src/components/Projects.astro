---
import { getCollection } from "astro:content";

export interface Props {
  limit?: number;
}

const { limit } = Astro.props;

let projects = await getCollection("projects");

projects = projects.sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);

if (limit) {
  projects = projects.slice(0, limit);
}
---

<section class="@container py-20 lg:py-28">
  <div class="wrapper space-y-8">
    <h2 class="text-3xl font-medium tracking-tighter @xl:text-4xl">
      Projects I have built.
    </h2>
    <ul
      class="grid grid-cols-[repeat(auto-fit,minmax(min(20rem,100%),1fr))] gap-4 @2xl:gap-6"
    >
      {
        projects.map((project) => (
          <li class="bg-card overflow-hidden rounded-lg border">
            <a
              href={`/projects/${project.id}`}
              aria-hidden="true"
              tabindex="-1"
            >
              <img
                src={project.data.img}
                alt={
                  project.data.img_alt ?? `Screenshot of ${project.data.title}`
                }
                width="362"
                height="265"
                class="w-full transition-transform hover:scale-105"
              />
            </a>
            <div class="grid gap-2 p-4">
              <h3 class="text-card-foreground hover:text-primary text-xl font-medium tracking-tighter transition-colors">
                <a href={`/projects/${project.id}`}>{project.data.title}</a>
              </h3>
              <p class="text-muted-foreground line-clamp-3">
                {project.data.description}
              </p>
            </div>
          </li>
        ))
      }
    </ul>
  </div>
</section>
